<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöó SUV Analyzer ULTIMATE PRO MAX - –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä SUV</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f0f1e 0%, #1a1a2e 100%);
            color: #fff;
            min-height: 100vh;
        }
        .container { max-width: 1800px; margin: 0 auto; padding: 20px; }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 40px 20px;
            border-bottom: 3px solid #0066cc;
            background: linear-gradient(135deg, rgba(0, 102, 204, 0.1), rgba(30, 144, 255, 0.1));
            border-radius: 12px;
        }
        h1 { font-size: 2.5em; color: #1e90ff; }
        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }
        .stat-box {
            background: rgba(0, 102, 204, 0.2);
            border: 1px solid #0066cc;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }
        .stat-number { font-size: 1.8em; color: #1e90ff; font-weight: bold; }
        .stat-label { color: #b0b0b0; font-size: 0.8em; }
        .tabs {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
            border-bottom: 2px solid #2a2a3e;
        }
        .tab-btn {
            padding: 12px 20px;
            background: transparent;
            border: none;
            color: #b0b0b0;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        .tab-btn:hover { color: #1e90ff; }
        .tab-btn.active { color: #1e90ff; border-bottom-color: #1e90ff; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .card {
            background: linear-gradient(135deg, #2a2a3e 0%, #3a3a4e 100%);
            border: 1px solid #0066cc;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }
        .card:hover { transform: translateY(-5px); border-color: #1e90ff; }
        .card h3 { color: #1e90ff; margin-bottom: 10px; font-size: 1.3em; }
        .card-info { color: #b0b0b0; font-size: 0.9em; margin: 5px 0; }
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #1a1a2e;
            border-radius: 3px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0066cc, #1e90ff);
        }
        button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #0066cc, #1e90ff);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.95em;
            margin: 5px;
        }
        button:hover { transform: translateY(-2px); }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }
        .modal.active { display: flex; }
        .modal-content {
            background: #1a1a2e;
            border: 1px solid #0066cc;
            border-radius: 12px;
            padding: 30px;
            max-width: 1200px;
            width: 95%;
            max-height: 95vh;
            overflow-y: auto;
        }
        .modal-content h2 { color: #1e90ff; margin-bottom: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; color: #1e90ff; font-weight: 600; margin-bottom: 6px; font-size: 0.95em; }
        input, select {
            width: 100%;
            padding: 10px;
            background: #2a2a3e;
            border: 1px solid #0066cc;
            border-radius: 6px;
            color: #fff;
            font-size: 0.95em;
            margin-top: 4px;
        }
        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .custom-input-group {
            display: none;
        }
        .custom-input-group.show {
            display: block;
            margin-top: 10px;
            padding: 15px;
            background: #2a2a3e;
            border: 1px solid #0066cc;
            border-radius: 6px;
        }
        .section {
            background: #2a2a3e;
            border: 1px solid #0066cc;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .section h3 {
            color: #1e90ff;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0;
            user-select: none;
            font-size: 1em;
        }
        .section-content { display: none; margin-top: 12px; }
        .section-content.open { display: block; }
        .question-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 12px;
        }
        .question {
            background: #1a1a2e;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 10px;
            font-size: 0.9em;
            position: relative;
        }
        .question label { margin-bottom: 4px; font-size: 0.85em; color: #1e90ff; }
        .question .sublabel { font-size: 0.75em; color: #888; font-style: italic; }
        .question input, .question select { font-size: 0.9em; padding: 8px; }
        .question-weight {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #1e90ff;
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 0.7em;
            font-weight: bold;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: #2a2a3e;
            border: 1px solid #0066cc;
            border-radius: 8px;
            font-size: 0.85em;
        }
        .comparison-table th, .comparison-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #0066cc;
        }
        .comparison-table th {
            background: #1a1a2e;
            color: #1e90ff;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        .comparison-table tr:hover { background: #3a3a4e; }
        .chart-container {
            background: #2a2a3e;
            border: 1px solid #0066cc;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            position: relative;
            height: 320px;
        }
        .chart-title { color: #1e90ff; font-weight: bold; font-size: 0.95em; margin-bottom: 10px; }
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .info-table {
            width: 100%;
            margin: 15px 0;
            background: #2a2a3e;
            border: 1px solid #0066cc;
            border-radius: 8px;
            overflow: hidden;
        }
        .info-table th, .info-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #0066cc;
        }
        .info-table th {
            background: #1a1a2e;
            color: #1e90ff;
            font-weight: bold;
        }
        .info-table tr:hover { background: #3a3a4e; }
        .empty-state { text-align: center; padding: 40px 20px; color: #b0b0b0; }
        .vehicle-selector {
            background: #2a2a3e;
            border: 1px solid #0066cc;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
        }
        .checkbox-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 12px 0;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            background: #1a1a2e;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #333;
        }
        .checkbox-item input {
            width: 18px;
            height: 18px;
            margin-right: 10px;
            accent-color: #0066cc;
        }
        .checkbox-item label {
            margin: 0;
            color: #b0b0b0;
            cursor: pointer;
            font-size: 0.9em;
        }
        .divider { height: 1px; background: linear-gradient(90deg, transparent, #0066cc, transparent); margin: 20px 0; }
        .hint { color: #888; font-size: 0.85em; font-style: italic; margin-top: 5px; }
        
        /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
        .smart-recommendation {
            background: linear-gradient(135deg, #2a2a3e 0%, #1a1a2e 100%);
            border: 1px solid #0066cc;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .recommendation-card {
            background: linear-gradient(135deg, #2a2a3e, #1a1a2e);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #1e90ff;
        }
        .heatmap-cell {
            text-align: center;
            font-weight: bold;
            border-radius: 4px;
        }
        .score-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 8px;
        }
        .insight-modal {
            max-width: 700px;
        }
        .category-score {
            display: flex;
            align-items: center;
            margin: 8px 0;
        }
        .category-name {
            width: 120px;
            font-weight: 600;
        }
        .category-bar {
            flex: 1;
            height: 10px;
            background: #1a1a2e;
            border-radius: 5px;
            overflow: hidden;
            margin: 0 10px;
        }
        .category-fill {
            height: 100%;
            border-radius: 5px;
        }
        .category-value {
            width: 40px;
            text-align: right;
            font-weight: bold;
        }
        .weight-legend {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        .weight-item {
            display: flex;
            align-items: center;
            font-size: 0.8em;
        }
        .weight-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .ai-score-breakdown {
            background: #2a2a3e;
            border: 1px solid #0066cc;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .breakdown-row {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px;
            border-bottom: 1px solid #333;
        }
        .breakdown-category {
            font-weight: bold;
            color: #1e90ff;
        }
        .breakdown-value {
            font-weight: bold;
        }
        .heatmap-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .heatmap-table th, .heatmap-table td {
            padding: 8px;
            text-align: center;
            border: 1px solid #333;
        }
        .heatmap-table th {
            background: #1a1a2e;
            color: #1e90ff;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöó SUV Analyzer ULTIMATE PRO MAX</h1>
            <p style="color: #b0b0b0; margin: 10px 0;">300 –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Ä¢ 30+ –ì—Ä–∞—Ñ–∏–∫–æ–≤ ‚Ä¢ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä ‚Ä¢ –£–º–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚Ä¢ AI –û—Ü–µ–Ω–∫–∞</p>
            <div class="hero-stats">
                <div class="stat-box"><div class="stat-number">300</div><div class="stat-label">–í–æ–ø—Ä–æ—Å–æ–≤</div></div>
                <div class="stat-box"><div class="stat-number">30+</div><div class="stat-label">–ì—Ä–∞—Ñ–∏–∫–æ–≤</div></div>
                <div class="stat-box"><div class="stat-number">‚àû</div><div class="stat-label">–ú–∞—Ä–∫–∏ –∞–≤—Ç–æ</div></div>
                <div class="stat-box"><div class="stat-number">AI</div><div class="stat-label">–û—Ü–µ–Ω–∫–∞</div></div>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('dashboard')">üìä –ü–∞–Ω–µ–ª—å</button>
            <button class="tab-btn" onclick="switchTab('vehicles')">üöó –ú–∞—à–∏–Ω—ã</button>
            <button class="tab-btn" onclick="switchTab('comparison')">‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ</button>
            <button class="tab-btn" onclick="switchTab('analytics')">üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
            <button class="tab-btn" onclick="switchTab('scoring')">üß† –û—Ü–µ–Ω–∫–∞ AI</button>
            <button class="tab-btn" onclick="switchTab('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </div>

        <div id="dashboard" class="tab-content active">
            <h2>üìä –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h2>
            <button onclick="openAddModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–∞—à–∏–Ω—É</button>
            <div class="grid" id="dashboardGrid"></div>
        </div>

        <div id="vehicles" class="tab-content">
            <h2>üöó –í—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</h2>
            <button onclick="openAddModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–∞—à–∏–Ω—É</button>
            <div class="grid" id="vehiclesGrid"></div>
        </div>

        <div id="comparison" class="tab-content">
            <h2>‚öñÔ∏è –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ</h2>
            <div id="comparisonContent"></div>
        </div>

        <div id="analytics" class="tab-content">
            <h2>üìà –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
            <div id="analyticsContent"></div>
        </div>

        <div id="scoring" class="tab-content">
            <h2>üß† –û—Ü–µ–Ω–∫–∞ AI</h2>
            <div id="scoringContent"></div>
        </div>

        <div id="settings" class="tab-content">
            <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h2>
            <button onclick="exportDatabase()">üíæ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
            <button onclick="document.getElementById('importFile').click()">üìÇ –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
            <button onclick="clearAllData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
            <input type="file" id="importFile" accept=".json" onchange="importDatabase(event)" style="display:none;">
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="vehicleModal" class="modal">
        <div class="modal-content">
            <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–∞—à–∏–Ω—É</h2>
            <div class="form-group">
                <label>–ú–∞—Ä–∫–∞ (Brand) - –≤—ã–±–µ—Ä–∏—Ç–µ –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ</label>
                <select id="vehicleBrand" onchange="handleBrandChange()">
                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫—É --</option>
                    <optgroup label="–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ (Popular)">
                        <option value="Toyota">Toyota</option>
                        <option value="Honda">Honda</option>
                        <option value="Hyundai">Hyundai</option>
                        <option value="Kia">Kia</option>
                        <option value="Jeep">Jeep</option>
                        <option value="Ford">Ford</option>
                        <option value="BMW">BMW</option>
                        <option value="Mercedes-Benz">Mercedes-Benz</option>
                        <option value="Audi">Audi</option>
                        <option value="Volkswagen">Volkswagen</option>
                        <option value="Mazda">Mazda</option>
                        <option value="Nissan">Nissan</option>
                        <option value="Subaru">Subaru</option>
                        <option value="Mitsubishi">Mitsubishi</option>
                        <option value="Chevrolet">Chevrolet</option>
                        <option value="GMC">GMC</option>
                        <option value="Tesla">Tesla</option>
                        <option value="Lexus">Lexus</option>
                        <option value="Infiniti">Infiniti</option>
                        <option value="Acura">Acura</option>
                        <option value="Range Rover">Range Rover</option>
                        <option value="Land Rover">Land Rover</option>
                        <option value="Volvo">Volvo</option>
                    </optgroup>
                    <optgroup label="–ü—Ä–µ–º–∏—É–º (Luxury)">
                        <option value="Porsche">Porsche</option>
                        <option value="Ferrari">Ferrari</option>
                        <option value="Lamborghini">Lamborghini</option>
                        <option value="Rolls-Royce">Rolls-Royce</option>
                        <option value="Bentley">Bentley</option>
                        <option value="Maserati">Maserati</option>
                        <option value="Jaguar">Jaguar</option>
                    </optgroup>
                    <optgroup label="–ö–∏—Ç–∞–π—Å–∫–∏–µ (Chinese)">
                        <option value="BYD">BYD</option>
                        <option value="NIO">NIO</option>
                        <option value="XPeng">XPeng</option>
                        <option value="Li Auto">Li Auto</option>
                        <option value="Geely">Geely</option>
                        <option value="GAC Aion">GAC Aion</option>
                    </optgroup>
                    <optgroup label="–î—Ä—É–≥–∏–µ (Other)">
                        <option value="custom">‚úèÔ∏è –í–≤–µ–¥–∏—Ç–µ –≤—Ä—É—á–Ω—É—é (Enter custom)</option>
                    </optgroup>
                </select>
                <div id="customBrandInput" class="custom-input-group">
                    <label>–í–≤–µ–¥–∏—Ç–µ –º–∞—Ä–∫—É –≤—Ä—É—á–Ω—É—é (Enter brand name)</label>
                    <input type="text" id="customBrandText" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Cupra, Polestar, Fisker...">
                </div>
                <div class="hint">üí° –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞ –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ—é –º–∞—Ä–∫—É</div>
            </div>

            <div class="form-group">
                <label>–ú–æ–¥–µ–ª—å (Model)</label>
                <input type="text" id="vehicleModel" placeholder="Highlander, CR-V, X5, GLC...">
            </div>

            <div class="input-row">
                <div class="form-group">
                    <label>–ì–æ–¥ (Year)</label>
                    <input type="number" id="vehicleYear" placeholder="2024">
                </div>
                <div class="form-group">
                    <label>–¶–µ–Ω–∞ $ (Price)</label>
                    <input type="number" id="vehiclePrice" placeholder="35000">
                </div>
            </div>

            <button onclick="saveVehicle()">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button onclick="closeModal()" style="background: #666;">‚ùå –û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <div id="checklistModal" class="modal">
        <div class="modal-content">
            <h2 id="checklistTitle">–ß–µ–∫–ª–∏—Å—Ç</h2>
            <div id="checklistContent" style="max-height: 500px; overflow-y: auto;"></div>
            <div style="margin-top: 20px;">
                <button onclick="saveChecklist()">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button onclick="closeModal()" style="background: #666;">‚ùå –û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div id="insightsModal" class="modal">
        <div class="modal-content insight-modal">
            <h2 id="insightsTitle">–ò–Ω—Å–∞–π—Ç—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è</h2>
            <div id="insightsContent"></div>
            <div style="margin-top: 20px;">
                <button onclick="closeModal()" style="background: #666;">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        let vehicles = [];
        let selectedVehicles = [];
        let editingVehicleId = null;

        // ============ AI SCORING SYSTEM WITH WEIGHTS ============
        const questionWeights = {
            // –ö–†–ò–¢–ò–ß–ù–û –í–ê–ñ–ù–´–ï (2.0-3.0 –±–∞–ª–ª–∞)
            safety: 3.0,
            nhtsa: 2.5,
            airbags: 2.5,
            autobraking: 2.5,
            lanekeep: 2.5,
            blindspot: 2.5,
            abs: 2.5,
            reliability: 2.3,
            engine: 2.2,
            transmission: 2.2,
            hp: 2.0,
            torque: 2.0,
            clearance: 2.0,
            
            // –í–´–°–û–ö–ê–Ø –í–ê–ñ–ù–û–°–¢–¨ (1.5-1.9 –±–∞–ª–ª–∞)
            warranty: 1.9,
            towing: 1.8,
            cargovolume: 1.8,
            seats: 1.7,
            thirdrow: 1.7,
            performance: 1.6,
            economy: 1.6,
            tech: 1.6,
            carplay: 1.5,
            android_auto: 1.5,
            gps_nav: 1.5,
            
            // –°–†–ï–î–ù–Ø–Ø –í–ê–ñ–ù–û–°–¢–¨ (1.0-1.4 –±–∞–ª–ª–∞)
            comfort: 1.4,
            price: 1.4,
            maintenance_cost: 1.3,
            maint_int: 1.3,
            acceleration: 1.2,
            topspeed: 1.2,
            brakingdist: 1.2,
            range: 1.2,
            screensize: 1.1,
            rearcamera: 1.1,
            camera360: 1.1,
            offroad: 1.0,
            
            // –ù–ò–ó–ö–ê–Ø –í–ê–ñ–ù–û–°–¢–¨ (0.5-0.9 –±–∞–ª–ª–∞)
            leather: 0.9,
            heatedseat: 0.9,
            ventilated: 0.8,
            sunroof: 0.8,
            pano_roof: 0.7,
            design: 0.6,
            appeal: 0.6,
            paint_type: 0.5,
            chrome: 0.5,
            spoiler: 0.5,
            
            // –ú–ò–ù–ò–ú–ê–õ–¨–ù–ê–Ø –í–ê–ñ–ù–û–°–¢–¨ (0.05-0.4 –±–∞–ª–ª–∞)
            wheel_size: 0.4,
            tire_opts: 0.3,
            spare_tire: 0.3,
            door_handles: 0.2,
            side_stripes: 0.1,
            run_lights: 0.1,
            rain_wipers: 0.05
        };

        // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –∏—Ö –≤–µ—Å–∞ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
        const categoryWeights = {
            safety: 3.0,
            performance: 2.5,
            reliability: 2.3,
            practicality: 2.0,
            technology: 1.8,
            comfort: 1.5,
            economy: 1.4,
            design: 0.8
        };

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Å–∞ –≤–æ–ø—Ä–æ—Å–∞
        function getQuestionWeight(questionId) {
            return questionWeights[questionId] || 1.0; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 1.0
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–æ–ø—Ä–æ—Å–∞
        function getQuestionCategory(questionId) {
            // –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
            if (['safety', 'nhtsa', 'airbags', 'autobraking', 'lanekeep', 'blindspot', 'abs', 'stability', 'traction', 'hill_start', 'hill_descent', 'isofix', 'alarm', 'side_airbags', 'curtain_airbags', 'iihs', 'rollover'].includes(questionId)) {
                return 'safety';
            }
            // –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            if (['hp', 'torque', 'acceleration', 'topspeed', 'performance', 'engine', 'transmission', 'cylinders', 'enginetype', 'turbo', 'gears', 'drive_modes'].includes(questionId)) {
                return 'performance';
            }
            // –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
            if (['reliability', 'warranty', 'maint_int', 'maint_cost', 'lifespan', 'engine_recalls', 'trans_recalls', 'eng_rel', 'trans_rel'].includes(questionId)) {
                return 'reliability';
            }
            // –ü—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å
            if (['seats', 'thirdrow', 'cargovolume', 'towing', 'clearance', 'weight', 'wheelbase', 'approach_angle', 'departure_angle', 'breakover', 'wading'].includes(questionId)) {
                return 'practicality';
            }
            // –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
            if (['tech', 'carplay', 'android_auto', 'gps_nav', 'screensize', 'rearcamera', 'camera360', 'ota', 'hud', 'wireless_charge', 'remote_start', 'voice_ctrl', 'wifi', '5g', 'bluetooth', 'speakers', 'audio_power'].includes(questionId)) {
                return 'technology';
            }
            // –ö–æ–º—Ñ–æ—Ä—Ç
            if (['comfort', 'leather', 'heatedseat', 'ventilated', 'massage', 'lumbar', 'power_seats', 'seat_mem', 'sunroof', 'pano_roof', 'soundproof', 'climate_zones', 'cupholders', 'storage', 'interior_mat'].includes(questionId)) {
                return 'comfort';
            }
            // –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å
            if (['price', 'economy', 'mpg', 'monthly', 'apr', 'ownership', 'freeservice', 'co2', 'oil_cost', 'service_cost'].includes(questionId)) {
                return 'economy';
            }
            // –î–∏–∑–∞–π–Ω
            if (['design', 'appeal', 'paint_type', 'chrome', 'spoiler', 'running_boards', 'fog_lights', 'run_lights', 'wheel_size', 'door_handles', 'side_stripes'].includes(questionId)) {
                return 'design';
            }
            return 'other';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Å–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function getCategoryWeight(category) {
            return categoryWeights[category] || 1.0;
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ AI –æ—Ü–µ–Ω–∫–∏
        function calculateAIScore(vehicle) {
            if (!vehicle.data || Object.keys(vehicle.data).length === 0) return 0;

            let totalScore = 0;
            let totalWeight = 0;
            const categoryScores = {};

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            Object.keys(categoryWeights).forEach(cat => {
                categoryScores[cat] = { score: 0, weight: 0 };
            });

            // –ü—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º
            getAllQuestions().forEach(q => {
                const value = vehicle.data[q.id];
                if (value === undefined || value === null || value === '') return;

                const questionWeight = getQuestionWeight(q.id);
                const category = getQuestionCategory(q.id);
                const categoryWeight = getCategoryWeight(category);

                let questionScore = 0;

                // –†–∞—Å—á–µ—Ç –±–∞–ª–ª–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –≤–æ–ø—Ä–æ—Å–∞
                if (q.type === 'number') {
                    const numValue = parseFloat(value);
                    if (!isNaN(numValue)) {
                        if (q.id === 'price') {
                            questionScore = Math.max(0, 10 - numValue / 10000); // –ß–µ–º –¥–µ—à–µ–≤–ª–µ, —Ç–µ–º –ª—É—á—à–µ
                        } else if (q.id === 'mpg') {
                            questionScore = Math.min(10, numValue / 2); // –ß–µ–º –º–µ–Ω—å—à–µ —Ä–∞—Å—Ö–æ–¥, —Ç–µ–º –ª—É—á—à–µ
                        } else if (q.id === 'acceleration') {
                            questionScore = Math.max(0, 10 - numValue); // –ß–µ–º –±—ã—Å—Ç—Ä–µ–µ —Ä–∞–∑–≥–æ–Ω, —Ç–µ–º –ª—É—á—à–µ
                        } else if (['comfort', 'performance', 'reliability', 'safety', 'tech', 'appeal', 'design', 'economy', 'offroad'].includes(q.id)) {
                            questionScore = Math.min(10, numValue); // –†–µ–π—Ç–∏–Ω–≥–∏ –æ—Ç 1 –¥–æ 10
                        } else {
                            questionScore = Math.min(10, numValue / 10); // –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥—Ä—É–≥–∏—Ö —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
                        }
                    }
                } else if (q.type === 'select') {
                    // –î–ª—è —Å–µ–ª–µ–∫—Ç–æ–≤: –î–∞/–ù–µ—Ç –∏–ª–∏ –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
                    if (value.includes('–î–∞') || value.includes('Yes') || value === '5‚òÖ' || value === 'Good') {
                        questionScore = 10;
                    } else if (value.includes('–ù–µ—Ç') || value.includes('No') || value === '3‚òÖ' || value === 'Poor') {
                        questionScore = 0;
                    } else if (value === '4‚òÖ' || value === 'Acceptable') {
                        questionScore = 7;
                    } else {
                        questionScore = 5; // –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
                    }
                } else {
                    questionScore = 5; // –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π
                }

                // –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                const weightedScore = questionScore * questionWeight;
                totalScore += weightedScore;
                totalWeight += questionWeight;

                if (categoryScores[category]) {
                    categoryScores[category].score += weightedScore;
                    categoryScores[category].weight += questionWeight;
                }
            });

            // –†–∞—Å—á–µ—Ç –∏—Ç–æ–≥–æ–≤–æ–≥–æ –±–∞–ª–ª–∞
            const finalScore = totalWeight > 0 ? (totalScore / totalWeight) * 10 : 0;

            // –†–∞—Å—á–µ—Ç –±–∞–ª–ª–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            const categoryResults = {};
            Object.keys(categoryScores).forEach(cat => {
                if (categoryScores[cat].weight > 0) {
                    categoryResults[cat] = (categoryScores[cat].score / categoryScores[cat].weight) * 10;
                } else {
                    categoryResults[cat] = 0;
                }
            });

            return {
                total: Math.round(finalScore * 10) / 10,
                categories: categoryResults
            };
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ –æ—Ü–µ–Ω–∫–∏
        function getScoreColor(score) {
            if (score >= 8) return '#00cc66';
            if (score >= 6) return '#ffcc00';
            if (score >= 4) return '#ff6600';
            return '#ff3300';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –æ—Ü–µ–Ω–∫–∏
        function getScoreGradient(score) {
            if (score >= 8) return 'linear-gradient(90deg, #00cc66, #00ff88)';
            if (score >= 6) return 'linear-gradient(90deg, #ffcc00, #ffaa00)';
            return 'linear-gradient(90deg, #ff6600, #ff3300)';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –æ—Ü–µ–Ω–∫–∏
        function getScoreDescription(score) {
            if (score >= 9) return 'üèÜ –ò—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π';
            if (score >= 8) return '‚≠ê –û—Ç–ª–∏—á–Ω—ã–π';
            if (score >= 7) return 'üëç –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–π';
            if (score >= 6) return '‚úÖ –•–æ—Ä–æ—à–∏–π';
            if (score >= 5) return '‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–π';
            if (score >= 4) return 'üìâ –ù–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ';
            return '‚ùå –ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π';
        }

        // ============ –í–û–ü–†–û–°–´ –ß–ï–ö-–õ–ò–°–¢–ê ============
        // –¢–û–ü 50 –í–û–ü–†–û–°–û–í
        const top50 = [
            { ru: "–¶–µ–Ω–∞ (Price)", id: "price", type: "number" },
            { ru: "–ü–ª–∞—Ç–µ–∂/–º–µ—Å (Monthly payment)", id: "monthly", type: "number" },
            { ru: "APR % (Interest rate)", id: "apr", type: "number" },
            { ru: "–ì–∞—Ä–∞–Ω—Ç–∏—è –ª–µ—Ç (Warranty years)", id: "warranty", type: "number" },
            { ru: "–û–±—ä–µ–º –¥–≤ –ª (Engine displacement L)", id: "engine", type: "number" },
            { ru: "–õ.—Å. (Horsepower)", id: "hp", type: "number" },
            { ru: "Nm –∫—Ä—É—Ç—è—â (Torque Nm)", id: "torque", type: "number" },
            { ru: "–¢–æ–ø–ª–∏–≤–æ (Fuel type)", id: "fuel", type: "select", options: ["–ë–µ–Ω–∑–∏–Ω (Petrol)", "–î–∏–∑–µ–ª—å (Diesel)", "–ì–∏–±—Ä–∏–¥ (Hybrid)", "–≠–ª–µ–∫—Ç—Ä–æ (Electric)"] },
            { ru: "–†–∞—Å—Ö–æ–¥ –ª/100 (L/100km)", id: "mpg", type: "number" },
            { ru: "–ö–æ—Ä–æ–±–∫–∞ (Transmission)", id: "transmission", type: "select", options: ["–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è (Manual)", "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è (Automatic)", "CVT"] },
            { ru: "–ü—Ä–∏–≤–æ–¥ (Drive type)", id: "drive", type: "select", options: ["2WD", "AWD", "4WD"] },
            { ru: "–ö–ª–∏—Ä–µ–Ω—Å —Å–º (Ground clearance cm)", id: "clearance", type: "number" },
            { ru: "–ü–æ–¥—É—à–∫–∏ –∫–æ–ª (Airbags count)", id: "airbags", type: "number" },
            { ru: "NHTSA (NHTSA rating)", id: "nhtsa", type: "select", options: ["5‚òÖ", "4‚òÖ", "3‚òÖ"] },
            { ru: "–ê–≤—Ç–æ—Ç–æ—Ä–º–æ–∑–∞ (Auto braking)", id: "autobraking", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "Lane Keep (Lane keeping)", id: "lanekeep", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "Blind Spot (Blind spot)", id: "blindspot", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "CarPlay (Apple CarPlay)", id: "carplay", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "–õ—é–∫ (Sunroof)", id: "sunroof", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "–ö–æ–∂–∞ (Leather seats)", id: "leather", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "–ü–æ–¥–æ–≥—Ä–µ–≤ —Å–∏–¥ (Heated seats)", id: "heatedseat", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "–í–µ–Ω—Ç–∏–ª—è—Ü–∏—è —Å–∏–¥ (Ventilated seats)", id: "ventilated", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "–¢–û –∫–º (Maintenance interval km)", id: "maint_int", type: "number" },
            { ru: "–¢–û —Å—Ç–æ–∏–º–æ—Å—Ç—å (Maintenance cost)", id: "maint_cost", type: "number" },
            { ru: "–ë—É–∫—Å–∏—Ä–æ–≤–∫–∞ –∫–≥ (Towing capacity kg)", id: "towing", type: "number" },
            { ru: "0-60 —Å–µ–∫ (0-60 time sec)", id: "acceleration", type: "number" },
            { ru: "–¢–æ–ø-—Å–ø–∏–¥ –∫–º/—á (Top speed km/h)", id: "topspeed", type: "number" },
            { ru: "–¢–æ—Ä–º —Ä–∞—Å—Å—Ç –º (Braking distance m)", id: "brakingdist", type: "number" },
            { ru: "–ë–∞–∫ –ª (Tank size L)", id: "tanksize", type: "number" },
            { ru: "–ó–∞–ø–∞—Å —Ö–æ–¥–∞ –∫–º (Range km)", id: "range", type: "number" },
            { ru: "–≠–∫—Ä–∞–Ω –¥—é–π–º—ã (Screen size inches)", id: "screensize", type: "number" },
            { ru: "–ö–∞–º–µ—Ä–∞ –∑–∞–¥ (Rear camera)", id: "rearcamera", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "360 –∫–∞–º–µ—Ä–∞ (360 camera)", id: "camera360", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "–ü–æ–º–æ—â—å –¥–æ—Ä–æ–≥–µ (Roadside assist)", id: "roadside", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –¢–û –º–µ—Å (Free service months)", id: "freeservice", type: "number" },
            { ru: "3-–π —Ä—è–¥ (3rd row seats)", id: "thirdrow", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            { ru: "–ú–µ—Å—Ç–∞ –∫–æ–ª (Seat count)", id: "seats", type: "number" },
            { ru: "–ë–∞–≥–∞–∂–Ω–∏–∫ –ª (Cargo volume L)", id: "cargovolume", type: "number" },
            { ru: "–ú–∞—Å—Å–∞ –∫–≥ (Weight kg)", id: "weight", type: "number" },
            { ru: "–î–∏–∑–∞–π–Ω 1-10 (Design rating)", id: "design", type: "number" },
            { ru: "–ö–æ–º—Ñ–æ—Ä—Ç 1-10 (Comfort rating)", id: "comfort", type: "number" },
            { ru: "–ü—Ä–æ–∏–∑–≤ 1-10 (Performance rating)", id: "performance", type: "number" },
            { ru: "–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å 1-10 (Reliability rating)", id: "reliability", type: "number" },
            { ru: "–≠–∫–æ–Ω–æ–º–∏—è 1-10 (Economy rating)", id: "economy", type: "number" },
            { ru: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å 1-10 (Safety rating)", id: "safety", type: "number" },
            { ru: "–í–Ω–µ–¥–æ—Ä–æ–∂ 1-10 (Off-road capability)", id: "offroad", type: "number" },
            { ru: "–¢–µ—Ö–Ω–æ–ª–æ–≥ 1-10 (Technology rating)", id: "tech", type: "number" },
            { ru: "–ü—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å 1-10 (Appeal rating)", id: "appeal", type: "number" },
            { ru: "–°—Ç–æ–∏–º –≤–ª–∞–¥ 1-10 (Ownership cost)", id: "ownership", type: "number" },
        ];

        // –û–°–¢–ê–õ–¨–ù–´–ï 250 –í–û–ü–†–û–°–û–í
        const detailed250 = {
            engine: [
                { ru: "–¶–∏–ª–∏–Ω–¥—Ä—ã (Cylinders)", id: "cylinders", type: "number" },
                { ru: "–¢–∏–ø –¥–≤ (Engine type)", id: "enginetype", type: "select", options: ["I4", "V6", "V8", "W12", "Electric"] },
                { ru: "–¢—É—Ä–±–æ (Turbo)", id: "turbo", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Octane (Octane required)", id: "octane", type: "select", options: ["87", "89", "91", "93", "95"] },
                { ru: "0-100 —Å–µ–∫ (0-100 time sec)", id: "accel100", type: "number" },
                { ru: "CO2 g/km (CO2 emissions)", id: "co2", type: "number" },
                { ru: "–®—É–º –¥–ë (Sound level dB)", id: "sound", type: "number" },
                { ru: "–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –¥–≤ (Engine reliability 1-10)", id: "eng_rel", type: "number" },
                { ru: "–°—Ä–æ–∫ –∫–º (Lifespan km)", id: "lifespan", type: "number" },
                { ru: "–†–µ–º–µ–Ω—å –ì–†–ú –∫–º (Timing belt km)", id: "timing_belt", type: "number" },
                { ru: "–ò–Ω—Ç–µ—Ä–≤–∞–ª –º–∞—Å–ª–æ (Oil change km)", id: "oil_change", type: "number" },
                { ru: "–ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ö–ª (Coolant interval km)", id: "coolant_int", type: "number" },
                { ru: "–û–±—ä–µ–º –º–∞—Å–ª–∞ –ª (Oil capacity L)", id: "oil_capacity", type: "number" },
                { ru: "–°—Ç–æ–∏–º –º–∞—Å–ª–æ (Oil filter cost $)", id: "oil_cost", type: "number" },
                { ru: "–í–∏–±—Ä–∞—Ü–∏—è (Vibration level 1-10)", id: "vibration", type: "number" },
                { ru: "–®—É–º –Ω–∞ –•–• –¥–ë (Idle noise dB)", id: "idle_noise", type: "number" },
                { ru: "–í—Ö–æ–¥ –Ω–∞ –≥–∞–∑ (Throttle response 1-10)", id: "throttle", type: "number" },
                { ru: "–°–º–æ–ª –º–æ—â–Ω–æ—Å—Ç–∏ (Power smoothness 1-10)", id: "smooth_power", type: "number" },
                { ru: "–ù–∞–¥–¥—É–≤ —Ç–∏–ø (Turbo type)", id: "turbo_type", type: "text" },
                { ru: "Compression (Compression ratio)", id: "compression", type: "text" },
                { ru: "–í–ø—É—Å–∫ —Ç–∏–ø (Intake type)", id: "intake_type", type: "text" },
                { ru: "–í—ã–ø—É—Å–∫ —Ç–∏–ø (Exhaust type)", id: "exhaust_type", type: "text" },
                { ru: "–ö–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä (Catalytic converter)", id: "catalyst", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–± (Known issues)", id: "engine_issues", type: "text" },
                { ru: "–û—Ç–∑—ã–≤—ã –æ—Ç–∫–∞–∑—ã (Engine recalls count)", id: "engine_recalls", type: "number" },
            ],
            transmission: [
                { ru: "–ü–µ—Ä–µ–¥–∞—á–∏ (Gears count)", id: "gears", type: "number" },
                { ru: "–†–∞–∑–¥–∞—Ç–æ—á–Ω–∞—è (Transfer case)", id: "transfer_case", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª (Differential type)", id: "differential", type: "select", options: ["–û—Ç–∫—Ä—ã—Ç—ã–π (Open)", "Limited Slip (LSD)", "Locking"] },
                { ru: "4WD —Ä–µ–∂–∏–º—ã (4WD modes count)", id: "4wd_modes", type: "number" },
                { ru: "Terrain Response (Terrain Response)", id: "terrain", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–õ–µ–ø–µ—Å—Ç–∫–∏ (Paddle shifters)", id: "paddles", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ü–ª–∞–≤–Ω–æ—Å—Ç—å 1-10 (Smoothness rating)", id: "smooth", type: "number" },
                { ru: "–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –ö–ü–ü (Transmission reliability 1-10)", id: "trans_rel", type: "number" },
                { ru: "–û—Ç–∫–ª–∏–∫ –º—Å–µ–∫ (Response time msec)", id: "response_time", type: "number" },
                { ru: "–°–µ—Ä–≤–∏—Å –∫–º (Service interval km)", id: "service_int", type: "number" },
                { ru: "–°–µ—Ä–≤–∏—Å —Å—Ç–æ–∏–º (Service cost $)", id: "service_cost", type: "number" },
                { ru: "–°—Ä–æ–∫ –ö–ü–ü –∫–º (Transmission lifespan km)", id: "trans_life", type: "number" },
                { ru: "–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–± (Known issues)", id: "trans_issues", type: "text" },
                { ru: "–û—Ç–∑—ã–≤—ã –æ—Ç–∫–∞–∑—ã (Transmission recalls)", id: "trans_recalls", type: "number" },
                { ru: "–í–∏–±—Ä–∞—Ü–∏—è –ø–µ—Ä (Shift vibration 1-10)", id: "shift_vibration", type: "number" },
                { ru: "–¢–æ–ª—á–∫–∏ (Jerky shifts)", id: "jerky_shifts", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–†–µ–∂–∏–º—ã –≤–æ–∂–¥–µ–Ω–∏—è (Drive modes count)", id: "drive_modes", type: "number" },
                { ru: "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (Synchronizers type)", id: "synchronizers", type: "text" },
                { ru: "–ú–∞—Å–ª–æ –ö–ü–ü (Fluid type)", id: "fluid_type", type: "text" },
                { ru: "–í–º–µ—Å—Ç –º–∞—Å–ª–∞ –ª (Fluid capacity L)", id: "fluid_capacity", type: "number" },
            ],
            suspension: [
                { ru: "–ü–µ—Ä–µ–¥–Ω—è—è –ø–æ–¥–≤–µ—Å–∫–∞ (Front suspension type)", id: "front_susp", type: "select", options: ["MacPherson", "Double Wishbone", "Multi-link"] },
                { ru: "–ó–∞–¥–Ω—è—è –ø–æ–¥–≤–µ—Å–∫–∞ (Rear suspension type)", id: "rear_susp", type: "select", options: ["Solid Axle", "Independent", "Multi-link"] },
                { ru: "–ü—Ä—É–∂–∏–Ω—ã (Spring type)", id: "springs", type: "select", options: ["Coil Springs", "Leaf Springs", "Air Springs"] },
                { ru: "–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è (Adaptive suspension)", id: "adaptive", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ü–Ω–µ–≤–º–∞—Ç–∏—á–µ—Å–∫–∞—è (Air suspension)", id: "air_susp", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –≤—ã—Å–æ—Ç—ã (Height adjustment)", id: "height_adj", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–£–≥–æ–ª –≤—ä–µ–∑–¥–∞ (Approach angle degrees)", id: "approach_angle", type: "number" },
                { ru: "–£–≥–æ–ª –≤—ã–µ–∑–¥–∞ (Departure angle degrees)", id: "departure_angle", type: "number" },
                { ru: "–£–≥–æ–ª –ø–µ—Ä–µ–ª–æ–º–∞ (Breakover angle degrees)", id: "breakover", type: "number" },
                { ru: "–ö–æ–ª–µ—Å–Ω–∞—è –±–∞–∑–∞ —Å–º (Wheelbase cm)", id: "wheelbase", type: "number" },
                { ru: "–ö–∞—á–µ—Å—Ç–≤–æ 1-10 (Ride quality rating)", id: "ride_qual", type: "number" },
                { ru: "–î–æ—Ä–æ–∂ —à—É–º –¥–ë (Road noise dB)", id: "road_noise", type: "number" },
                { ru: "–í–µ—Ç—Ä–æ–≤ —à—É–º –¥–ë (Wind noise dB)", id: "wind_noise", type: "number" },
                { ru: "–ü–ª–æ—Ö–∏–µ –¥–æ—Ä–æ–≥–∏ (Rough road performance 1-10)", id: "rough_road", type: "number" },
                { ru: "–í–Ω–µ–¥–æ—Ä–æ–∂ 1-10 (Off-road capability 1-10)", id: "susp_offroad", type: "number" },
                { ru: "Amortisseurs (Shock absorber type)", id: "shocks", type: "text" },
                { ru: "–ñ–µ—Å—Ç–∫–æ—Å—Ç—å (Stiffness level 1-10)", id: "stiffness", type: "number" },
                { ru: "Rock Crawling (Rock crawling mode)", id: "rock_crawl", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ë—Ä–æ–¥ –≥–ª—É–±–∏–Ω–∞ —Å–º (Wading depth cm)", id: "wading", type: "number" },
                { ru: "–•–æ–¥ –ø—Ä—É–∂–∏–Ω —Å–º (Spring travel cm)", id: "spring_travel", type: "number" },
                { ru: "–ê—Ä—Ç–∏–∫—É–ª—è—Ü–∏—è % (Articulation percentage)", id: "articulation", type: "number" },
                { ru: "–†—É–ª–µ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Steering type)", id: "steering", type: "text" },
                { ru: "–ü–ª–∞–≤–Ω–æ—Å—Ç—å —Ä—É–ª—è (Steering smoothness 1-10)", id: "steering_smooth", type: "number" },
                { ru: "–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (Steering sensitivity 1-10)", id: "steering_sensitivity", type: "number" },
                { ru: "–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å (Steering feedback 1-10)", id: "steering_feedback", type: "number" },
            ],
            technology: [
                { ru: "Android Auto (Android Auto available)", id: "android_auto", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "GPS (GPS navigation)", id: "gps_nav", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ì–æ–ª–æ—Å (Voice control)", id: "voice_ctrl", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "WiFi (WiFi hotspot)", id: "wifi", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "5G (5G ready)", id: "5g", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Bluetooth –≤–µ—Ä—Å–∏—è (Bluetooth version)", id: "bluetooth", type: "number" },
                { ru: "–î–∏–Ω–∞–º–∏–∫–∏ (Speaker count)", id: "speakers", type: "number" },
                { ru: "–ú–æ—â–Ω–æ—Å—Ç—å audio (Audio wattage)", id: "audio_power", type: "number" },
                { ru: "–°–∞–±–≤—É—Ñ–µ—Ä (Subwoofer)", id: "subwoofer", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "DAB+ Radio (DAB+ radio)", id: "dab_radio", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "SiriusXM (SiriusXM satellite radio)", id: "sirius", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è (Wireless charging)", id: "wireless_charge", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "USB –ø–æ—Ä—Ç—ã (USB port count)", id: "usb_count", type: "number" },
                { ru: "OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (OTA updates)", id: "ota", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–£–¥–∞–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç (Remote start)", id: "remote_start", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "HUD (Head up display)", id: "hud", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–°–µ–Ω—Å–æ—Ä–Ω—ã–π (Touchscreen)", id: "touchscreen", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ü—Ä–æ—Ñ–∏–ª–∏ –≤–æ–¥–∏—Ç–µ–ª—è (Driver profiles)", id: "profiles", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–£–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (Remote unlock)", id: "remote_unlock", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ö–∞—á–µ—Å—Ç–≤–æ –∑–≤—É–∫–∞ 1-10 (Audio quality rating)", id: "audio_qual", type: "number" },
                { ru: "–≠–∫—Ä–∞–Ω —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (Display resolution)", id: "display_res", type: "text" },
                { ru: "–Ø—Ä–∫–æ—Å—Ç—å (Screen brightness level 1-10)", id: "screen_bright", type: "number" },
                { ru: "–ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º (Night mode available)", id: "night_mode", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç (AI assistant)", id: "ai_assistant", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Cloud storage)", id: "cloud_storage", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            ],
            safety: [
                { ru: "Forward Collision (Forward collision detection)", id: "forward_coll", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ü–µ—à–µ—Ö–æ–¥—ã (Pedestrian detection)", id: "ped_detect", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–í–µ–ª–æ—Å–∏–ø–µ–¥—ã (Cyclist detection)", id: "cyclist_detect", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "ABS (ABS braking system)", id: "abs", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Stability Control (Stability control)", id: "stability", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Traction Control (Traction control)", id: "traction", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Hill Start (Hill start assist)", id: "hill_start", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Hill Descent (Hill descent control)", id: "hill_descent", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "ISOFIX (ISOFIX anchors)", id: "isofix", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–°–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—è (Security alarm)", id: "alarm", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "GPS Tracking (GPS tracking)", id: "gps_track", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Immobilizer (Engine immobilizer)", id: "immob", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Keyless Entry (Keyless entry)", id: "keyless", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Push Button (Push button start)", id: "push_start", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Crash Notification (Crash notification)", id: "crash_notif", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ë–æ–∫–æ–≤—ã–µ –ø–æ–¥—É—à–∫–∏ (Side airbags)", id: "side_airbags", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–®—Ç–æ—Ä–∫–∏ –ø–æ–¥—É—à–∫–∏ (Curtain airbags)", id: "curtain_airbags", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–¢–∏–ø —Ç–æ—Ä–º–æ–∑–æ–≤ (Brake type)", id: "brake_type", type: "select", options: ["Disc (Disc)", "Drum (Drum)"] },
                { ru: "–ú–∞—Ç–µ—Ä–∏–∞–ª —Ç–æ—Ä–º–æ–∑ (Brake material)", id: "brake_mat", type: "select", options: ["Metallic", "Ceramic", "Carbon"] },
                { ru: "IIHS Rating (IIHS rating)", id: "iihs", type: "select", options: ["Good", "Acceptable", "Marginal", "Poor"] },
                { ru: "Rollover Protection (Rollover protection)", id: "rollover", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Auto Door Lock (Auto door lock)", id: "auto_lock", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Emergency Assist (Emergency assistance)", id: "emerg_assist", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Lane Change Warn (Lane change warning)", id: "lane_change", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Traffic Jam (Traffic jam assist)", id: "traffic_jam", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            ],
            comfort: [
                { ru: "–ú–∞—Ç–µ—Ä–∏–∞–ª —Å–∏–¥ (Seat material)", id: "seat_mat", type: "select", options: ["Cloth (–¢–∫–∞–Ω—å)", "Leather (–ö–æ–∂–∞)", "Suede (–ó–∞–º—à–∞)", "Alcantara"] },
                { ru: "–ó–∞–¥–Ω–∏–π –ø–æ–¥–æ–≥—Ä–µ–≤ (Rear heated seats)", id: "rear_heated", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ó–∞–¥–Ω—è—è –≤–µ–Ω—Ç–∏–ª (Rear ventilated seats)", id: "rear_vent", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ú–∞—Å—Å–∞–∂ —Å–∏–¥–µ–Ω–∏–π (Seat massage)", id: "massage", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ü–æ—è—Å–Ω–∏—á–Ω–∞—è (Lumbar support)", id: "lumbar", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Power Seats (Power seats)", id: "power_seats", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ü–∞–º—è—Ç—å —Å–∏–¥ (Seat memory profiles)", id: "seat_mem", type: "number" },
                { ru: "–ü–∞–Ω–æ—Ä–∞–º–Ω—ã–π –ª—é–∫ (Panoramic sunroof)", id: "pano_roof", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–®—É–º–æ–∏–∑–æ–ª—è—Ü–∏—è 1-10 (Sound insulation level)", id: "soundproof", type: "number" },
                { ru: "–ö–ª–∏–º–∞—Ç –∑–æ–Ω—ã (Climate zones count)", id: "climate_zones", type: "number" },
                { ru: "–ü–æ–¥—Å—Ç–∞–∫–∞–Ω–Ω–∏–∫–∏ (Cup holders count)", id: "cupholders", type: "number" },
                { ru: "–•—Ä–∞–Ω–∏–ª–∏—â–µ (Storage compartments)", id: "storage", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ì—Ä—É–∑–æ–≤—ã–µ –∫—Ä—é–∫–∏ (Cargo hooks count)", id: "cargo_hooks", type: "number" },
                { ru: "–ú–∞—Ç–µ—Ä–∏–∞–ª –∏–Ω—Ç–µ—Ä—å (Interior material quality)", id: "interior_mat", type: "select", options: ["Premium", "Standard", "Basic"] },
                { ru: "–¶–≤–µ—Ç–æ–≤—ã–µ –æ–ø—Ü–∏–∏ (Color options count)", id: "color_opts", type: "number" },
                { ru: "–ü–µ—Ä—Ñ–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (Perforated leather)", id: "perf_leather", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ü–∞–Ω–µ–ª—å –ø—Ä–∏–±–æ—Ä–æ–≤ (Dashboard material)", id: "dash_mat", type: "text" },
                { ru: "–†—É–ª–µ–≤–æ–µ –∫–æ–ª–µ—Å–æ (Steering wheel material)", id: "wheel_mat", type: "text" },
                { ru: "–ü–æ–¥–ª–æ–∫–æ—Ç–Ω–∏–∫ (Armrest adjustable)", id: "armrest_adj", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–õ–∞–º–ø—ã –∫–∞—Ä—Ç—ã (Reading lights count)", id: "read_lights", type: "number" },
            ],
            exterior: [
                { ru: "–ö—Ä–∞—Å–∫–∞ —Ç–∏–ø (Paint type)", id: "paint_type", type: "select", options: ["Metallic (–ú–µ—Ç–∞–ª–ª–∏–∫)", "Pearl (–ü–µ—Ä–ª–∞–º—É—Ç—Ä)", "Matte (–ú–∞—Ç–æ–≤–∞—è)"] },
                { ru: "Power Mirrors (Power mirrors)", id: "power_mir", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Heated Mirrors (Heated mirrors)", id: "heat_mir", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–°–ø–æ–π–ª–µ—Ä (Rear spoiler)", id: "spoiler", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ë–æ–∫–æ–≤—ã–µ –ø–æ—Ä–æ–≥–∏ (Running boards)", id: "running_boards", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ü—Ä–æ—Ç–∏–≤–æ—Ç—É–º–∞–Ω–Ω—ã–µ (Fog lights)", id: "fog_lights", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Running Lights (Running lights)", id: "run_lights", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Rain Wipers (Rain sensing wipers)", id: "rain_wipers", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Tow Hooks (Tow hooks)", id: "tow_hooks", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Chrome Trim (Chrome trim count)", id: "chrome", type: "number" },
                { ru: "–†–∞–∑–º–µ—Ä –∫–æ–ª–µ—Å (Wheel size options)", id: "wheel_size", type: "text" },
                { ru: "–û–ø—Ü–∏–∏ —à–∏–Ω (Tire options count)", id: "tire_opts", type: "number" },
                { ru: "–ó–∞–ø–∞—Å–∫–∞ (Spare tire type)", id: "spare_tire", type: "select", options: ["Full-size", "Temporary", "None (–ù–µ—Ç)"] },
                { ru: "–¢–∏–ø –∫—Ä—ã—à–∏ (Roof type)", id: "roof_type", type: "select", options: ["Fixed (–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)", "Panoramic (–ü–∞–Ω–æ—Ä–∞–º–Ω–∞—è)", "Glass (–°—Ç–µ–∫–ª–æ)"] },
                { ru: "–î–∏–∑–∞–π–Ω –ø—Ä–∏–≤–ª–µ–∫ 1-10 (Design appeal rating)", id: "design_appeal", type: "number" },
                { ru: "–î–≤–µ—Ä–Ω—ã–µ —Ä—É—á–∫–∏ (Door handle style)", id: "door_handles", type: "text" },
                { ru: "LED —Ñ–∞—Ä—ã (LED headlights)", id: "led_lights", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Ñ–∞—Ä—ã (Adaptive headlights)", id: "adaptive_lights", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "Auto Headlights (Auto headlights)", id: "auto_lights", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
                { ru: "–ë–æ–∫–æ–≤—ã–µ –ø–æ–ª–æ—Å–∫–∏ (Side stripe options)", id: "side_stripes", type: "select", options: ["–î–∞ (Yes)", "–ù–µ—Ç (No)"] },
            ],
        };

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
        function getAllQuestions() {
            let result = [...top50];
            Object.values(detailed250).forEach(cat => {
                result = result.concat(cat);
            });
            return result;
        }

        // ============ –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ============
        function handleBrandChange() {
            const select = document.getElementById('vehicleBrand');
            const customGroup = document.getElementById('customBrandInput');
            if (select.value === 'custom') {
                customGroup.classList.add('show');
            } else {
                customGroup.classList.remove('show');
            }
        }

        function loadVehicles() {
            const saved = localStorage.getItem('suv-vehicles');
            if (saved) vehicles = JSON.parse(saved);
            updateUI();
        }

        function saveToStorage() {
            localStorage.setItem('suv-vehicles', JSON.stringify(vehicles));
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            event.target.classList.add('active');
        }

        function updateUI() {
            renderDashboard();
            renderVehicles();
            renderComparison();
            renderAnalytics();
            renderScoring();
        }

        function renderDashboard() {
            const grid = document.getElementById('dashboardGrid');
            if (vehicles.length === 0) {
                grid.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;"><h2>–ù–µ—Ç –º–∞—à–∏–Ω (No vehicles)</h2><p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –º–∞—à–∏–Ω—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</p></div>';
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ AI –æ—Ü–µ–Ω–∫–µ
            const sortedVehicles = [...vehicles].sort((a, b) => calculateAIScore(b).total - calculateAIScore(a).total);
            
            const total = getAllQuestions().length;
            grid.innerHTML = sortedVehicles.map(v => {
                const aiScore = calculateAIScore(v);
                const answered = Object.keys(v.data || {}).length;
                const progress = Math.round((answered / total) * 100);
                
                return `
                    <div class="card">
                        <h3>${v.brand} ${v.model} <span class="score-badge" style="background: ${getScoreColor(aiScore.total)}">${aiScore.total}/10</span></h3>
                        <div class="card-info">üìÖ ${v.year} | üí∞ $${v.price}</div>
                        
                        <!-- AI —Ä–µ–π—Ç–∏–Ω–≥ -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                            <span>AI –û—Ü–µ–Ω–∫–∞:</span>
                            <strong style="color: ${getScoreColor(aiScore.total)}">${aiScore.total}/10</strong>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${aiScore.total * 10}%; background: ${getScoreGradient(aiScore.total)}"></div>
                        </div>
                        
                        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è -->
                        <div class="card-info">–ó–∞–ø–æ–ª–Ω–µ–Ω–æ: ${progress}% (${answered}/${total})</div>
                        
                        <button onclick="openChecklistModal('${v.id}')">‚úèÔ∏è –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑</button>
                        <button onclick="showVehicleInsights('${v.id}')">üîç –ò–Ω—Å–∞–π—Ç—ã</button>
                        <button onclick="deleteVehicle('${v.id}')" style="background: #dc3545;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
            }).join('');
        }

        function renderVehicles() {
            document.getElementById('vehiclesGrid').innerHTML = document.getElementById('dashboardGrid').innerHTML;
        }

        function renderScoring() {
            const container = document.getElementById('scoringContent');
            if (vehicles.length === 0) {
                container.innerHTML = '<div class="empty-state">–î–æ–±–∞–≤—å—Ç–µ –º–∞—à–∏–Ω—ã –¥–ª—è –æ—Ü–µ–Ω–∫–∏ AI</div>';
                return;
            }

            let html = '<h3>üß† –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ AI</h3>';
            
            // –õ–µ–≥–µ–Ω–¥–∞ –≤–µ—Å–æ–≤
            html += '<div class="ai-score-breakdown">';
            html += '<h4>‚öñÔ∏è –í–µ—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –æ—Ü–µ–Ω–∫–µ:</h4>';
            html += '<div class="weight-legend">';
            html += '<div class="weight-item"><div class="weight-color" style="background: #ff3300;"></div> –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (2.0-3.0)</div>';
            html += '<div class="weight-item"><div class="weight-color" style="background: #ff6600;"></div> –í—ã—Å–æ–∫–∏–µ (1.5-1.9)</div>';
            html += '<div class="weight-item"><div class="weight-color" style="background: #ffcc00;"></div> –°—Ä–µ–¥–Ω–∏–µ (1.0-1.4)</div>';
            html += '<div class="weight-item"><div class="weight-color" style="background: #66cc00;"></div> –ù–∏–∑–∫–∏–µ (0.5-0.9)</div>';
            html += '<div class="weight-item"><div class="weight-color" style="background: #00cc66;"></div> –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ (0.05-0.4)</div>';
            html += '</div>';
            html += '</div>';

            // –†–µ–π—Ç–∏–Ω–≥ –º–∞—à–∏–Ω –ø–æ AI –æ—Ü–µ–Ω–∫–µ
            html += '<h3 style="color: #1e90ff; margin-top: 20px;">üèÜ –†–µ–π—Ç–∏–Ω–≥ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –ø–æ AI –æ—Ü–µ–Ω–∫–µ</h3>';
            const sorted = [...vehicles].sort((a, b) => calculateAIScore(b).total - calculateAIScore(a).total);
            html += '<table class="info-table"><tr><th>üèÜ –ú–µ—Å—Ç–æ</th><th>–ê–≤—Ç–æ–º–æ–±–∏–ª—å</th><th>üß† AI –û—Ü–µ–Ω–∫–∞</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</th><th>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</th></tr>';
            
            sorted.forEach((v, i) => {
                const aiScore = calculateAIScore(v);
                const description = getScoreDescription(aiScore.total);
                
                let categoriesHtml = '';
                Object.entries(aiScore.categories).forEach(([cat, score]) => {
                    if (score > 0) {
                        categoriesHtml += `<div style="display: inline-block; margin: 2px; padding: 2px 6px; background: ${getScoreColor(score)}; border-radius: 10px; font-size: 0.7em;">${cat}: ${score.toFixed(1)}</div>`;
                    }
                });
                
                html += `<tr>
                    <td><strong style="font-size: 1.2em;">#${i+1}</strong></td>
                    <td><strong>${v.brand} ${v.model}</strong></td>
                    <td><strong style="color: ${getScoreColor(aiScore.total)}; font-size: 1.1em;">${aiScore.total}/10</strong></td>
                    <td>${categoriesHtml}</td>
                    <td>${description}</td>
                </tr>`;
            });
            html += '</table>';

            // –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω—ã
            html += '<h3 style="color: #1e90ff; margin-top: 30px;">üìä –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –æ—Ü–µ–Ω–æ–∫</h3>';
            sorted.forEach(v => {
                const aiScore = calculateAIScore(v);
                html += `<div class="ai-score-breakdown" style="margin-bottom: 20px;">`;
                html += `<h4>${v.brand} ${v.model} - ${aiScore.total}/10</h4>`;
                
                Object.entries(aiScore.categories).forEach(([cat, score]) => {
                    if (score > 0) {
                        html += `<div class="breakdown-row">
                            <span class="breakdown-category">${cat}</span>
                            <div class="progress-bar" style="width: 60%; margin: 0 10px;">
                                <div class="progress-fill" style="width: ${score * 10}%; background: ${getScoreColor(score)};"></div>
                            </div>
                            <span class="breakdown-value">${score.toFixed(1)}/10</span>
                        </div>`;
                    }
                });
                html += `</div>`;
            });

            container.innerHTML = html;
        }

        function renderComparison() {
            const container = document.getElementById('comparisonContent');
            if (vehicles.length === 0) {
                container.innerHTML = '<div class="empty-state">–î–æ–±–∞–≤—å—Ç–µ –º–∞—à–∏–Ω—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (Add vehicles)</div>';
                return;
            }

            let html = '<div class="vehicle-selector"><h3>üîç –í—ã–±–µ—Ä–∏—Ç–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (Select for comparison)</h3><div class="checkbox-list">';
            vehicles.forEach(v => {
                const checked = selectedVehicles.includes(v.id) ? 'checked' : '';
                const aiScore = calculateAIScore(v);
                html += `<div class="checkbox-item"><input type="checkbox" id="sel_${v.id}" ${checked} onchange="toggleVehicleSelection('${v.id}')"><label for="sel_${v.id}">${v.brand} ${v.model} <span style="color: ${getScoreColor(aiScore.total)}">(${aiScore.total}/10)</span></label></div>`;
            });
            html += '</div></div>';

            if (selectedVehicles.length === 0) {
                html += '<div class="empty-state">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—à–∏–Ω—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (Select vehicles)</div>';
                container.innerHTML = html;
                return;
            }

            const selected = vehicles.filter(v => selectedVehicles.includes(v.id));
            const allQ = getAllQuestions();

            // –£–º–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
            html += generateSmartRecommendation(selected);

            // –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ AI –æ—Ü–µ–Ω–æ–∫ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            html += '<div class="divider"></div><h3>üéØ –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ AI –æ—Ü–µ–Ω–æ–∫ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>';
            html += '<div style="overflow-x: auto;"><table class="heatmap-table">';
            html += '<tr><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>';
            selected.forEach(v => html += `<th>${v.brand} ${v.model}</th>`);
            html += '</tr>';
            
            const categories = ['safety', 'performance', 'reliability', 'practicality', 'technology', 'comfort', 'economy', 'design'];
            categories.forEach(cat => {
                html += `<tr><td style="text-align: left; font-weight: bold;">${cat}</td>`;
                selected.forEach(vehicle => {
                    const aiScore = calculateAIScore(vehicle);
                    const score = aiScore.categories[cat] || 0;
                    const color = getScoreColor(score);
                    html += `<td class="heatmap-cell" style="background: ${color}; color: ${score > 5 ? '#fff' : '#000'}">${score.toFixed(1)}</td>`;
                });
                html += '</tr>';
            });
            
            // –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞
            html += `<tr style="font-weight: bold; background: #1a1a2e;"><td>–ò–¢–û–ì–û</td>`;
            selected.forEach(vehicle => {
                const aiScore = calculateAIScore(vehicle);
                const color = getScoreColor(aiScore.total);
                html += `<td class="heatmap-cell" style="background: ${color}; color: #fff">${aiScore.total}/10</td>`;
            });
            html += '</tr>';
            html += '</table></div>';

            html += '<div class="divider"></div><h3>üìä –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (Comparison table)</h3>';
            html += '<table class="comparison-table"><tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th>';
            selected.forEach(v => html += `<th>${v.brand} ${v.model}<br><small>${calculateAIScore(v).total}/10</small></th>`);
            html += '</tr>';

            let filledCount = 0;
            allQ.forEach(q => {
                const hasData = selected.some(v => v.data?.[q.id]);
                if (!hasData) return;
                filledCount++;
                html += `<tr><td>${q.ru}</td>`;
                selected.forEach(v => {
                    const value = v.data?.[q.id] || "‚Äî";
                    html += `<td><strong>${value}</strong></td>`;
                });
                html += '</tr>';
            });
            html += '</table>';
            html += `<p style="color: #1e90ff; font-size: 0.9em;">–ü–æ–∫–∞–∑–∞–Ω–æ (Shown): ${filledCount}/${allQ.length}</p>`;

            if (selected.length >= 2) {
                html += '<div class="divider"></div><h3>üìà 30+ –ì—Ä–∞—Ñ–∏–∫–æ–≤ (Charts)</h3>';
                html += '<div class="chart-grid">';
                // –î–æ–±–∞–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏...
                html += '<div class="chart-container"><div class="chart-title">üí∞ –¶–µ–Ω–∞ ($)</div><canvas id="c1"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üèéÔ∏è –ú–æ—â–Ω–æ—Å—Ç—å (–ª.—Å.)</div><canvas id="c2"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">‚ö° –ö—Ä—É—Ç –º–æ–º–µ–Ω—Ç (Nm)</div><canvas id="c3"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">‚õΩ –†–∞—Å—Ö–æ–¥ (–ª/100)</div><canvas id="c4"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üìä AI –û—Ü–µ–Ω–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</div><canvas id="c5"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üèÅ 0-60 (—Å–µ–∫)</div><canvas id="c6"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üöÄ –ú–∞–∫—Å —Å–∫–æ—Ä–æ—Å—Ç—å</div><canvas id="c7"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üí™ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</div><canvas id="c8"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üîß –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</div><canvas id="c9"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</div><canvas id="c10"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üëç –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è</div><canvas id="c11"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">ü™ë –ö–æ–º—Ñ–æ—Ä—Ç</div><canvas id="c12"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üí∞ –†–∞—Å—Ö–æ–¥—ã 5 –ª–µ—Ç</div><canvas id="c13"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üì¶ –ë–∞–≥–∞–∂–Ω–∏–∫</div><canvas id="c14"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üí∫ –ú–µ—Å—Ç–∞</div><canvas id="c15"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üöö –ë—É–∫—Å–∏—Ä–æ–≤–∫–∞</div><canvas id="c16"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üìè –ö–ª–∏—Ä–µ–Ω—Å</div><canvas id="c17"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">‚è±Ô∏è –¢–æ—Ä–º —Ä–∞—Å—Å—Ç</div><canvas id="c18"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üîã –ó–∞–ø–∞—Å —Ö–æ–¥–∞</div><canvas id="c19"></canvas></div>';
                html += '<div class="chart-container"><div class="chart-title">üèÜ –ò–¢–û–ì–û AI –æ—Ü–µ–Ω–∫–∞</div><canvas id="c20"></canvas></div>';
                html += '</div>';
            }

            container.innerHTML = html;

            if (selected.length >= 2) {
                setTimeout(() => drawAllCharts(selected), 100);
            }
        }

        function generateSmartRecommendation(selected) {
            if (selected.length < 2) return '';
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ AI –æ—Ü–µ–Ω–∫–µ
            const sorted = [...selected].sort((a, b) => calculateAIScore(b).total - calculateAIScore(a).total);
            const bestOverall = sorted[0];
            
            // –ù–∞—Ö–æ–¥–∏–º –ª—É—á—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ
            const bestValue = [...selected].sort((a, b) => {
                const aValue = calculateAIScore(a).total / (a.price || 50000);
                const bValue = calculateAIScore(b).total / (b.price || 50000);
                return bValue - aValue;
            })[0];
            
            let html = '<div class="smart-recommendation">';
            html += '<h3 style="color: #1e90ff;">üèÜ –£–º–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ AI</h3>';
            
            // –õ—É—á—à–∏–π –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É
            html += `<div class="recommendation-card" style="border-left-color: #1e90ff;">
                <h4>ü•á –õ—É—á—à–∏–π –æ–±—â–∏–π –≤—ã–±–æ—Ä</h4>
                <p><strong>${bestOverall.brand} ${bestOverall.model}</strong></p>
                <p>AI –û—Ü–µ–Ω–∫–∞: ${calculateAIScore(bestOverall).total}/10 | –¶–µ–Ω–∞: $${bestOverall.price}</p>
                <div class="progress-bar"><div class="progress-fill" style="width: ${calculateAIScore(bestOverall).total * 10}%"></div></div>
            </div>`;
            
            // –õ—É—á—à–∏–π –ø–æ —Ü–µ–Ω–µ
            html += `<div class="recommendation-card" style="border-left-color: #00cc66;">
                <h4>üí∞ –õ—É—á—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω—ã –∏ –∫–∞—á–µ—Å—Ç–≤–∞</h4>
                <p><strong>${bestValue.brand} ${bestValue.model}</strong></p>
                <p>AI –û—Ü–µ–Ω–∫–∞: ${calculateAIScore(bestValue).total}/10 | –¶–µ–Ω–∞: $${bestValue.price}</p>
                <div class="progress-bar"><div class="progress-fill" style="width: ${calculateAIScore(bestValue).total * 10}%; background: linear-gradient(90deg, #00cc66, #00ff88);"></div></div>
            </div>`;
            
            html += '</div>';
            return html;
        }

        function drawAllCharts(selected) {
            const createChart = (id, type, labels, data, colors) => {
                const ctx = document.getElementById(id);
                if (!ctx) return;
                new Chart(ctx, {
                    type: type,
                    data: { 
                        labels, 
                        datasets: [{ 
                            data, 
                            backgroundColor: colors || '#0066cc', 
                            borderColor: colors || '#1e90ff',
                            borderWidth: 2
                        }] 
                    },
                    options: { 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        plugins: { 
                            legend: { 
                                display: type === 'radar' || type === 'doughnut',
                                labels: { color: '#fff' } 
                            } 
                        }, 
                        scales: type !== 'radar' && type !== 'doughnut' ? { 
                            y: { 
                                ticks: { color: '#fff' }, 
                                grid: { color: '#333' } 
                            }, 
                            x: { 
                                ticks: { color: '#fff' }, 
                                grid: { color: '#333' } 
                            } 
                        } : {} 
                    }
                });
            };

            const labels = selected.map(v => v.brand);
            const colors = ['#0066cc', '#1e90ff', '#00d4ff', '#ffaa00', '#ff6600', '#cc00cc'];
            
            createChart('c1', 'bar', labels, selected.map(v => v.price || 0));
            createChart('c2', 'bar', labels, selected.map(v => v.data?.hp || 0));
            createChart('c3', 'line', labels, selected.map(v => v.data?.torque || 0));
            createChart('c4', 'bar', labels, selected.map(v => v.data?.mpg || 0));

            // –†–∞–¥–∞—Ä-–¥–∏–∞–≥—Ä–∞–º–º–∞ AI –æ—Ü–µ–Ω–æ–∫ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            new Chart(document.getElementById('c5'), {
                type: 'radar',
                data: {
                    labels: ['–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', '–ü—Ä–æ–∏–∑–≤', '–ù–∞–¥–µ–∂–Ω', '–ü—Ä–∞–∫—Ç–∏—á', '–¢–µ—Ö–Ω–æ–ª–æ–≥', '–ö–æ–º—Ñ–æ—Ä—Ç', '–≠–∫–æ–Ω–æ–º', '–î–∏–∑–∞–π–Ω'],
                    datasets: selected.map((v, i) => {
                        const aiScore = calculateAIScore(v);
                        return {
                            label: v.brand,
                            data: [
                                aiScore.categories.safety || 0,
                                aiScore.categories.performance || 0,
                                aiScore.categories.reliability || 0,
                                aiScore.categories.practicality || 0,
                                aiScore.categories.technology || 0,
                                aiScore.categories.comfort || 0,
                                aiScore.categories.economy || 0,
                                aiScore.categories.design || 0
                            ],
                            backgroundColor: `rgba(${i * 50}, 102, 204, 0.2)`,
                            borderColor: colors[i],
                            borderWidth: 2,
                            pointBackgroundColor: colors[i]
                        };
                    })
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { legend: { labels: { color: '#fff' } } }, 
                    scales: { 
                        r: { 
                            ticks: { color: '#fff', backdropColor: 'transparent' }, 
                            grid: { color: '#333' },
                            angleLines: { color: '#333' }
                        } 
                    } 
                }
            });

            createChart('c6', 'bar', labels, selected.map(v => v.data?.acceleration || 0));
            createChart('c7', 'bar', labels, selected.map(v => v.data?.topspeed || 0));
            createChart('c8', 'bar', labels, selected.map(v => v.data?.performance || 5));
            createChart('c9', 'bar', labels, selected.map(v => v.data?.reliability || 5));
            createChart('c10', 'bar', labels, selected.map(v => v.data?.safety || 5));
            createChart('c11', 'bar', labels, selected.map(v => v.data?.tech || 5));
            createChart('c12', 'bar', labels, selected.map(v => v.data?.comfort || 5));
            createChart('c13', 'bar', labels, selected.map(v => ((v.price || 0) + ((v.data?.maint_cost || 1000) * 5))));
            createChart('c14', 'bar', labels, selected.map(v => v.data?.cargovolume || 0));
            createChart('c15', 'bar', labels, selected.map(v => v.data?.seats || 0));
            createChart('c16', 'bar', labels, selected.map(v => v.data?.towing || 0));
            createChart('c17', 'bar', labels, selected.map(v => v.data?.clearance || 0));
            createChart('c18', 'bar', labels, selected.map(v => v.data?.brakingdist || 0));
            createChart('c19', 'bar', labels, selected.map(v => v.data?.range || 0));
            createChart('c20', 'bar', labels, selected.map(v => calculateAIScore(v).total));
        }

        function renderAnalytics() {
            const container = document.getElementById('analyticsContent');
            if (vehicles.length === 0) {
                container.innerHTML = '<div class="empty-state">–î–æ–±–∞–≤—å—Ç–µ –º–∞—à–∏–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (Add vehicles)</div>';
                return;
            }

            let html = '<h3>üß† –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h3>';
            
            // –¢–∞–±–ª–∏—Ü–∞ AI –æ—Ü–µ–Ω–æ–∫
            html += '<h4 style="color: #1e90ff; margin-top: 20px;">üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ AI –æ—Ü–µ–Ω–æ–∫</h4>';
            html += '<table class="info-table"><tr><th>–ú–∞—Ä–∫–∞/–ú–æ–¥–µ–ª—å</th><th>AI –û—Ü–µ–Ω–∫–∞</th><th>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</th><th>–ü—Ä–æ–∏–∑–≤.</th><th>–ù–∞–¥–µ–∂.</th><th>–ü—Ä–∞–∫—Ç.</th><th>–¢–µ—Ö–Ω.</th><th>–ö–æ–º—Ñ–æ—Ä—Ç</th><th>–≠–∫–æ–Ω–æ–º.</th><th>–î–∏–∑–∞–π–Ω</th><th>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</th></tr>';
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ AI –æ—Ü–µ–Ω–∫–µ
            const sortedVehicles = [...vehicles].sort((a, b) => calculateAIScore(b).total - calculateAIScore(a).total);
            
            sortedVehicles.forEach(vehicle => {
                const aiScore = calculateAIScore(vehicle);
                const description = getScoreDescription(aiScore.total);
                const recColor = getScoreColor(aiScore.total);
                
                html += `<tr>
                    <td><strong>${vehicle.brand} ${vehicle.model}</strong></td>
                    <td style="color: ${recColor}; font-weight: bold;">${aiScore.total}/10</td>
                    <td>${(aiScore.categories.safety || 0).toFixed(1)}</td>
                    <td>${(aiScore.categories.performance || 0).toFixed(1)}</td>
                    <td>${(aiScore.categories.reliability || 0).toFixed(1)}</td>
                    <td>${(aiScore.categories.practicality || 0).toFixed(1)}</td>
                    <td>${(aiScore.categories.technology || 0).toFixed(1)}</td>
                    <td>${(aiScore.categories.comfort || 0).toFixed(1)}</td>
                    <td>${(aiScore.categories.economy || 0).toFixed(1)}</td>
                    <td>${(aiScore.categories.design || 0).toFixed(1)}</td>
                    <td style="color: ${recColor}">${description}</td>
                </tr>`;
            });
            html += '</table>';

            // –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
            html += '<h4 style="color: #1e90ff; margin-top: 30px;">üéØ –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫</h4>';
            html += '<div style="overflow-x: auto;"><table class="info-table" style="min-width: 800px;">';
            html += '<tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th>';
            sortedVehicles.forEach(v => html += `<th>${v.brand} ${v.model}</th>`);
            html += '</tr>';
            
            const keyMetrics = [
                {id: 'price', name: '–¶–µ–Ω–∞ ($)'},
                {id: 'hp', name: '–ú–æ—â–Ω–æ—Å—Ç—å (–ª.—Å.)'},
                {id: 'torque', name: '–ö—Ä—É—Ç—è—â–∏–π –º–æ–º–µ–Ω—Ç (Nm)'},
                {id: 'mpg', name: '–†–∞—Å—Ö–æ–¥ (–ª/100–∫–º)'},
                {id: 'safety', name: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (1-10)'},
                {id: 'comfort', name: '–ö–æ–º—Ñ–æ—Ä—Ç (1-10)'},
                {id: 'reliability', name: '–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å (1-10)'},
                {id: 'tech', name: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (1-10)'},
                {id: 'warranty', name: '–ì–∞—Ä–∞–Ω—Ç–∏—è (–ª–µ—Ç)'},
                {id: 'seats', name: '–ö–æ–ª-–≤–æ –º–µ—Å—Ç'},
                {id: 'cargovolume', name: '–ë–∞–≥–∞–∂–Ω–∏–∫ (–ª)'},
                {id: 'towing', name: '–ë—É–∫—Å–∏—Ä–æ–≤–∫–∞ (–∫–≥)'}
            ];
            
            keyMetrics.forEach(metric => {
                html += `<tr><td>${metric.name}</td>`;
                sortedVehicles.forEach(vehicle => {
                    const value = vehicle.data?.[metric.id] || vehicle[metric.id] || 0;
                    const normalized = normalizeValueForHeatmap(metric.id, value);
                    const color = getHeatmapColor(normalized);
                    html += `<td class="heatmap-cell" style="background: ${color}; color: ${normalized > 50 ? '#fff' : '#000'}">${value}</td>`;
                });
                html += '</tr>';
            });
            html += '</table></div>';

            container.innerHTML = html;
        }

        function normalizeValueForHeatmap(metric, value) {
            const numValue = parseFloat(value) || 0;
            switch(metric) {
                case 'price': return Math.max(0, 100 - (numValue / 1000));
                case 'hp': return Math.min(100, (numValue / 3));
                case 'mpg': return Math.min(100, (30 - numValue) * 3);
                default: return Math.min(100, numValue * 10);
            }
        }

        function getHeatmapColor(value) {
            if (value >= 80) return '#00cc66';
            if (value >= 60) return '#66cc00';
            if (value >= 40) return '#ffcc00';
            if (value >= 20) return '#ff6600';
            return '#ff3300';
        }

        function showVehicleInsights(vehicleId) {
            const vehicle = vehicles.find(v => v.id === vehicleId);
            if (!vehicle) return;

            document.getElementById('insightsTitle').textContent = `üîç –ò–Ω—Å–∞–π—Ç—ã: ${vehicle.brand} ${vehicle.model}`;
            
            const aiScore = calculateAIScore(vehicle);
            
            let html = `<div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 2em; color: ${getScoreColor(aiScore.total)}; font-weight: bold;">${aiScore.total}/10</div>
                <div>${getScoreDescription(aiScore.total)}</div>
            </div>`;
            
            html += '<h3 style="color: #1e90ff; margin-top: 20px;">üìä –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>';
            html += '<div style="margin: 20px 0;">';
            
            const categories = [
                {name: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', value: aiScore.categories.safety || 0, color: '#0066cc'},
                {name: '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', value: aiScore.categories.performance || 0, color: '#ff6600'},
                {name: '–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å', value: aiScore.categories.reliability || 0, color: '#00cc66'},
                {name: '–ü—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å', value: aiScore.categories.practicality || 0, color: '#cc00cc'},
                {name: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏', value: aiScore.categories.technology || 0, color: '#ffcc00'},
                {name: '–ö–æ–º—Ñ–æ—Ä—Ç', value: aiScore.categories.comfort || 0, color: '#00d4ff'},
                {name: '–≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å', value: aiScore.categories.economy || 0, color: '#ff3300'},
                {name: '–î–∏–∑–∞–π–Ω', value: aiScore.categories.design || 0, color: '#66cc00'}
            ];
            
            categories.forEach(cat => {
                html += `<div class="category-score">
                    <div class="category-name">${cat.name}</div>
                    <div class="category-bar">
                        <div class="category-fill" style="width: ${cat.value * 10}%; background: ${cat.color};"></div>
                    </div>
                    <div class="category-value">${cat.value.toFixed(1)}/10</div>
                </div>`;
            });
            
            html += '</div>';
            
            // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
            html += '<h3 style="color: #1e90ff; margin-top: 20px;">üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ AI</h3>';
            html += '<div style="background: #2a2a3e; padding: 15px; border-radius: 8px; margin: 10px 0;">';
            
            // –û–±—â–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
            if (aiScore.total >= 8) {
                html += '<p>‚úÖ <strong>–û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä!</strong> –≠—Ç–æ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª—å –∏–º–µ–µ—Ç –≤—ã—Å–æ–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ –≤—Å–µ–º –∫–ª—é—á–µ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º.</p>';
            } else if (aiScore.total >= 6) {
                html += '<p>üëç <strong>–•–æ—Ä–æ—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç.</strong> –ê–≤—Ç–æ–º–æ–±–∏–ª—å –∏–º–µ–µ—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.</p>';
            } else if (aiScore.total >= 4) {
                html += '<p>‚ö†Ô∏è <strong>–°—Ä–µ–¥–Ω–∏–π –≤—ã–±–æ—Ä.</strong> –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏.</p>';
            } else {
                html += '<p>‚ùå <strong>–¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è.</strong> –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã.</p>';
            }
            
            // –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            categories.forEach(cat => {
                if (cat.value < 5) {
                    html += `<p>üîç <strong>${cat.name}:</strong> –ù–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —É–ª—É—á—à–µ–Ω–∏–µ —ç—Ç–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.</p>`;
                } else if (cat.value > 8) {
                    html += `<p>‚≠ê <strong>${cat.name}:</strong> –í—ã—Å–æ–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å. –≠—Ç–æ —Å–∏–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è.</p>`;
                }
            });
            
            html += '</div>';
            
            document.getElementById('insightsContent').innerHTML = html;
            document.getElementById('insightsModal').classList.add('active');
        }

        function toggleVehicleSelection(vehicleId) {
            if (selectedVehicles.includes(vehicleId)) {
                selectedVehicles = selectedVehicles.filter(id => id !== vehicleId);
            } else {
                selectedVehicles.push(vehicleId);
            }
            renderComparison();
        }

        function openAddModal() {
            document.getElementById('vehicleModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('vehicleModal').classList.remove('active');
            document.getElementById('checklistModal').classList.remove('active');
            document.getElementById('insightsModal').classList.remove('active');
        }

        function saveVehicle() {
            let brand = document.getElementById('vehicleBrand').value;
            if (brand === 'custom') {
                brand = document.getElementById('customBrandText').value.trim();
            }
            const model = document.getElementById('vehicleModel').value.trim();
            const year = document.getElementById('vehicleYear').value;
            const price = document.getElementById('vehiclePrice').value;

            if (!brand || !model || !year) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è! (Fill all fields!)');
                return;
            }

            vehicles.push({
                id: Date.now().toString(),
                brand, model, year, price,
                data: {}
            });

            saveToStorage();
            updateUI();
            closeModal();
            document.getElementById('vehicleModel').value = '';
            document.getElementById('vehicleYear').value = '';
            document.getElementById('vehiclePrice').value = '';
            document.getElementById('vehicleBrand').value = '';
            document.getElementById('customBrandText').value = '';
        }

        function openChecklistModal(vehicleId) {
            editingVehicleId = vehicleId;
            const vehicle = vehicles.find(v => v.id === vehicleId);
            if (!vehicle) return;

            document.getElementById('checklistTitle').textContent = `${vehicle.brand} ${vehicle.model} - 300 –≤–æ–ø—Ä–æ—Å–æ–≤`;

            let html = '<h3 style="color: #1e90ff; margin-top: 0;">‚≠ê –¢–û–ü 50 (–ù–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ)</h3>';
            html += '<div class="question-grid">';

            top50.forEach(q => {
                const value = vehicle.data[q.id] || '';
                const parts = q.ru.split('(');
                const rus = parts[0].trim();
                const eng = parts[1] ? parts[1].replace(')', '') : '';
                const weight = getQuestionWeight(q.id);

                html += `<div class="question"><label>${rus}</label><div class="sublabel">(${eng})</div>`;
                if (q.type === 'number') {
                    html += `<input type="number" data-id="${q.id}" value="${value}">`;
                } else if (q.type === 'select') {
                    html += `<select data-id="${q.id}"><option value="">--</option>`;
                    q.options.forEach(opt => html += `<option value="${opt}" ${value === opt ? 'selected' : ''}>${opt}</option>`);
                    html += `</select>`;
                } else {
                    html += `<input type="text" data-id="${q.id}" value="${value}">`;
                }
                html += `<div class="question-weight">${weight}</div>`;
                html += `</div>`;
            });

            html += '</div>';

            Object.entries(detailed250).forEach(([ catName, questions ]) => {
                html += `<div class="section" onclick="toggleSection(event, '${catName}')">
                    <h3>${catName.toUpperCase()} (${questions.length}) ‚ñº</h3>
                    <div class="section-content" id="section-${catName}">
                        <div class="question-grid">`;

                questions.forEach(q => {
                    const value = vehicle.data[q.id] || '';
                    const parts = q.ru.split('(');
                    const rus = parts[0].trim();
                    const eng = parts[1] ? parts[1].replace(')', '') : '';
                    const weight = getQuestionWeight(q.id);

                    html += `<div class="question"><label>${rus}</label><div class="sublabel">(${eng})</div>`;
                    if (q.type === 'number') {
                        html += `<input type="number" data-id="${q.id}" value="${value}">`;
                    } else if (q.type === 'select') {
                        html += `<select data-id="${q.id}"><option value="">--</option>`;
                        q.options.forEach(opt => html += `<option value="${opt}" ${value === opt ? 'selected' : ''}>${opt}</option>`);
                        html += `</select>`;
                    } else {
                        html += `<input type="text" data-id="${q.id}" value="${value}">`;
                    }
                    html += `<div class="question-weight">${weight}</div>`;
                    html += `</div>`;
                });

                html += `</div></div></div>`;
            });

            document.getElementById('checklistContent').innerHTML = html;
            document.getElementById('checklistModal').classList.add('active');
        }

        function toggleSection(e, catName) {
            if (e.target.tagName === 'H3') {
                document.getElementById(`section-${catName}`).classList.toggle('open');
            }
        }

        function saveChecklist() {
            const vehicle = vehicles.find(v => v.id === editingVehicleId);
            if (!vehicle) return;

            getAllQuestions().forEach(q => {
                const inputs = document.querySelectorAll(`[data-id="${q.id}"]`);
                if (inputs.length > 0) {
                    vehicle.data[q.id] = inputs[0].value;
                }
            });

            saveToStorage();
            updateUI();
            closeModal();
        }

        function deleteVehicle(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å? (Delete?)')) {
                vehicles = vehicles.filter(v => v.id !== id);
                selectedVehicles = selectedVehicles.filter(vid => vid !== id);
                saveToStorage();
                updateUI();
            }
        }

        function exportDatabase() {
            const data = JSON.stringify(vehicles, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `suv-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

        function importDatabase(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(result) {
                try {
                    vehicles = JSON.parse(result.target.result);
                    saveToStorage();
                    updateUI();
                } catch (error) {
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (Load error)');
                }
            };
            reader.readAsText(file);
        }

        function clearAllData() {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ? (Delete ALL data?)')) {
                vehicles = [];
                selectedVehicles = [];
                localStorage.clear();
                updateUI();
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        loadVehicles();
    </script>
</body>
</html>